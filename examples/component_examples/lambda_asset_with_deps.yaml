# Lambda Asset with Dependencies
#
# This creates an asset that depends on other assets and runs on a schedule.

component_type: lambda_component.LambdaFunctionComponent

params:
  lambda_config:
    function_name: aggregate-metrics
    invocation_type: RequestResponse  # Sync invocation
    payload_mode: full

  asset:
    key: daily_metrics
    description: Daily metrics aggregated by Lambda
    group_name: analytics

    # Depends on upstream assets
    deps:
      - raw_events
      - user_sessions

    config_schema:
      metric_types:
        type: array
        default: ["pageviews", "conversions", "revenue"]
      aggregation_window:
        type: string
        default: "24h"

    metadata:
      owner: analytics-team
      dashboard_url: "https://analytics.example.com/daily-metrics"

  # Run daily at 2 AM UTC
  schedule:
    cron_schedule: "0 2 * * *"
    execution_timezone: UTC
