# Environment Variables for Dagster+ Agent with Lambda Run Launcher
#
# Copy this file and set the actual values for your deployment.
# These variables should be configured in your ECS task definition.

# ============================================================================
# REQUIRED: Dagster Cloud Configuration
# ============================================================================

# Dagster Cloud agent token (REQUIRED)
# Get this from Dagster Cloud: Deployment Settings > Agents > Create Agent Token
DAGSTER_CLOUD_AGENT_TOKEN=your_agent_token_here

# ============================================================================
# REQUIRED: AWS Configuration
# ============================================================================

# AWS region where Lambda functions are deployed
AWS_REGION=us-east-1
AWS_DEFAULT_REGION=us-east-1

# ============================================================================
# OPTIONAL: Lambda Run Launcher Configuration
# ============================================================================

# Default Lambda function to invoke if not specified per-job
# Can be a function name or full ARN
DEFAULT_LAMBDA_FUNCTION=dagster-default-handler

# Default invocation type: 'Event' (async) or 'RequestResponse' (sync)
DEFAULT_INVOCATION_TYPE=Event

# Timeout for synchronous Lambda invocations (seconds)
# Maximum: 900 (15 minutes, Lambda's max execution time)
LAMBDA_SYNC_TIMEOUT=300

# Payload format mode (default: 'full')
# Options:
#   - 'full': Complete payload with run metadata, config, env vars (for new Lambda functions)
#   - 'config_only': Just the run_config dictionary
#   - 'ops_only': Just the ops config from run_config.ops
#   - 'custom': Extract specific path using PAYLOAD_CONFIG_PATH (for existing Lambda functions)
PAYLOAD_MODE=full

# Path to extract in 'custom' mode (dot notation)
# Example: 'ops.my_op.config' extracts just that op's config
# Only used when PAYLOAD_MODE=custom
# PAYLOAD_CONFIG_PATH=ops.my_op.config

# ============================================================================
# OPTIONAL: Dagster Cloud Explicit Configuration
# ============================================================================

# These are typically extracted from the agent token, but can be set explicitly
# DAGSTER_CLOUD_ORG_NAME=your-org-name
# DAGSTER_CLOUD_DEPLOYMENT_NAME=prod

# ============================================================================
# OPTIONAL: Custom Environment Variables
# ============================================================================

# Add any custom environment variables that your Lambda functions need
# These will be passed in the payload if listed in dagster.yaml env_vars

# Example:
# CUSTOM_API_KEY=your_api_key_here
# DATABASE_CONNECTION_STRING=your_connection_string

# ============================================================================
# NOTES
# ============================================================================

# 1. AWS Credentials:
#    - Do NOT set AWS_ACCESS_KEY_ID or AWS_SECRET_ACCESS_KEY
#    - Use IAM roles for ECS tasks instead (recommended)
#    - The ECS task role should have lambda:InvokeFunction permission
#
# 2. Sensitive Values:
#    - Store secrets in AWS Secrets Manager or Parameter Store
#    - Reference them in your ECS task definition
#    - Never commit actual secrets to version control
#
# 3. Environment Variable Expansion:
#    - Variables in dagster.yaml use ${VAR_NAME} or ${VAR_NAME:default}
#    - The entrypoint.py script expands these at runtime
